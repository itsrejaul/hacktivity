# SSL Pinning bypass using frida and objection

**Credits:**

**Rejaul Islam**  
_Security enthusiast_

............................................

Clear, beginner-friendly, with every command shown as a `bash` snippet and a short explanation of _why_ and _what happens_. Copy-paste the commands into your terminal.

---

## 1) Install Python tools locally

```

pip3 install frida frida-tools objection
```

**Why / what it does**

- `pip3 install ...` installs Python packages to your environment.
- `frida` is the Python bindings used by many tools and scripts.
- `frida-tools` provides command-line utilities like `frida-ps`.
- `objection` is a runtime mobile exploration toolkit built on Frida.
- Make sure `pip3` points to the Python 3 you use (use a venv if you prefer isolated installs).

**Notes**

- `frida` (Python package) _must_ match the major/minor version of the `frida-server` binary you will put on the device. Mismatched versions often fail to connect.

---

## 2) Check Android device connection & architecture

```
# List connected devices
adb devices
```

```
# Show Android CPU ABI (preferred)
adb shell getprop ro.product.cpu.abi
```

```
# Alternate: show kernel architecture
adb shell uname -m
```

**Why / what it does**

- `adb devices` confirms your device is connected and ADB authorized.
- `getprop ro.product.cpu.abi` returns the CPU ABI used for native libs (example outputs: `arm64-v8a`, `armeabi-v7a`, `x86_64`).
- `uname -m` shows kernel arch; helpful as a double-check.

**Expected result example**

```
# adb devices
List of devices attached
127.0.0.1:6555  device

# adb shell getprop ro.product.cpu.abi
x86_64
```

---

## 3) Find the target app package name

```
# Search installed packages for the target app (case-insensitive)
adb shell pm list packages | grep -i <app_name>
# Example result:
# package:com.example.android
```

**Why / what it does**

- `pm list packages` lists installed package names.
- `grep -i <app_name>` filters for your app; replace `<app_name>` with a unique part of the app name.
- You need the package name (e.g. `com.example.android`) for `objection` and Frida attach commands.

---

## 4) Download the matching frida-server binary

```
# download frida from
https://github.com/frida/frida/releases
```

```
# Example: download a specific frida-server release (replace version & arch as needed)
wget https://github.com/frida/frida/releases/download/17.3.2/frida-server-17.3.2-android-x86_64.xz
```

**Why / what it does**

- Downloads the prebuilt `frida-server` for the release `17.3.2` and target arch `x86_64`.
- **Important:** Replace `17.3.2` and `x86_64` with the version and architecture that match your setup and the output from `getprop ro.product.cpu.abi`.

**Decompress (if the file is .xz)**

```
# Decompress .xz to get the binary file
unxz -d frida-server-17.3.2-android-x86_64.xz
```

**Why**

- Releases often provide `.xz` compressed binaries. Decompress to obtain the executable.

---

## 5) Rename for convenience and make executable

```
# Rename to a short, convenient name
mv frida-server-17.3.2-android-x86_64 frida

# Make it executable locally (optional, but helpful to check)
chmod +x frida
```

**Why / what it does**

- `mv` shortens filename (makes subsequent commands simpler).
- `chmod +x` ensures the file has execute permission.

---

## 6) Push frida to the device and run it

```
# Push the binary to device temporary folder
adb push frida /data/local/tmp/

# Enter device shell
adb shell

# inside device shell (now run these commands in device shell)
cd /data/local/tmp
ls -l frida      # confirm file is present and executable
chmod +x frida   # ensure execute bit set on-device
./frida &        # run frida in background (optional to exit)
exit             # leave device shell (back to host)
```

**Why / what it does**

- `adb push` copies the frida binary to the device.
- `/data/local/tmp` is usually writable and convenient for tests (no root required on many devices).
- `chmod +x` on-device ensures the file can run.
- `./frida &` launches frida-server; `&` runs it in background so shell returns. You can also use `nohup ./frida &` if needed.
- In some Android versions you may need root privileges to bind to certain ports or run the server; `adb root` or `su` on device may be required. Many modern devices disallow `adb root`.

**Troubleshooting**

- If `Permission denied` appears, try pushing to `/data/local/tmp` (writable) or run with `su` if you have root.
- If `./frida` immediately exits, check `logcat` for errors: `adb logcat -d | grep frida`.

---

## 7) Verify frida-server is reachable from host

```
# List processes on device (via frida-tools)
frida-ps -U
# or using frida client tool
frida-ls-devices
```

**Why / what it does**

- `frida-ps -U` lists processes on the USB-connected device. If you see a list of processes, connection works.
- If this command errors, ensure `frida-server` is running on the device and your local `frida` / `frida-tools` versions match the server.

**Expected**

```
# frida-ps -U
 PID  Name
1234 com.example.android
...
```

---

## SSL pinning bypass universal script

```
    /*
    Universal Android SSL Pinning Bypass
    by Anthony Viriya (@avltree9798)

    $ frida -U -f org.package.name -l universal-ssl-check-bypass.js
    */

    Java.perform(function() {
        var TrustManagerImpl = Java.use('com.android.org.conscrypt.TrustManagerImpl');
        var ArrayList = Java.use("java.util.ArrayList");
        TrustManagerImpl.verifyChain.implementation = function(untrustedChain, trustAnchorChain,
            host, clientAuth, ocspData, tlsSctData) {
            console.log("[+] Bypassing TrustManagerImpl->verifyChain()");
            return untrustedChain;
        }
        TrustManagerImpl.checkTrustedRecursive.implementation = function(certs, host, clientAuth, untrustedChain,
            trustAnchorChain, used) {
            console.log("[+] Bypassing TrustManagerImpl->checkTrustedRecursive()");
            return ArrayList.$new();
        };
    });


```

## 8) Using Objection to disable SSL pinning (quick)

```
# Launch objection in gadget mode (app already running) or use -gadget to inject into a running app:
objection --gadget <application_package_name_here> explore -s "android sslpinning disable"
```

**Why / what it does**

- `objection --gadget <package>` tells Objection to attach to the app process identified by `<package>`.
- `explore` opens an interactive exploration shell inside the app (a REPL).
- `-s "android sslpinning disable"` runs a simple script/command to disable some SSL pinning implementations automatically.
- This is convenient for quick testing without writing your own Frida script.

**Notes**

- `objection` uses Frida under the hood — it requires `frida-server` running on the device and a compatible `frida` installation locally.

---

## 9) Example: Run Frida with a custom bypass script

```
# Launch the app (replace package) and inject your script
frida -U -f com.example.android -l /path/to/universal_ssl_pinning_bypass.js --no-pause
```

**Why / what it does**

- `-U` = connect to USB device.
- `-f com.example.android` = spawn (start) the target app by package name and attach immediately.
- `-l /path/to/script.js` = load your Frida script (e.g., a universal SSL pinning bypass). The script runs right after injection.
- `--no-pause` (or `-D --no-pause` in some frida versions) prevents Frida from pausing the app at spawn so it runs immediately.
- **If you want to attach to an _already running_ process, replace `-f <pkg>` with the PID or process name (e.g., `frida -U -n com.example.android -l script.js`)**.

**Common workflow**

1. `frida -U -f com.example.android -l script.js --no-pause` — spawn and inject.
2. Or: `frida -U -f com.example.android -l script.js `

---

### Finally After complete step 9, you can intercept req into burpsuite.... Stay Tuned------

**Note:** This is not the only method for bypassing _SSL pinning_. The overall process remains similar, but you might need to use a different _.js script or perform extra steps depending on the target app_. This note is provided to clarify the required process; I hope you find it helpful.

---

## 10) Helpful extra commands & troubleshooting

```
# Check device logs (filter frida)
adb logcat | grep -i frida

# Check that the app process exists
adb shell ps | grep com.example.android

# If frida-ps returns nothing, try specifying timeout
frida-ps -U --timeout 10000

# Kill frida-server on device (if you need to restart)
adb shell pkill -f frida || adb shell killall frida
```

**Why**

- `logcat` helps debug why `frida-server` might be failing.
- `ps` confirms the app is running.
- Restarting `frida-server` is a common step after changing versions.

---

## 11) Version compatibility checklist (must-read)

- Ensure **frida-server binary version** == **frida Python package version** (same major/minor). Example: `frida-server-17.3.2` ↔ `frida==17.3.2`.
- Ensure you downloaded the correct **architecture** (e.g., `arm64`, `armv7`, `x86`, `x86_64`).
- If using `objection`, ensure its Frida dependency aligns with the local Frida packages.

---

## 12) Final tips

- Always check **versions**: mismatches are the #1 cause of “cannot connect” errors.
- Use `adb logcat` and `frida-ps -U` to confirm connectivity.
- If the device is not rooted and you face permission errors, try `/data/local/tmp`; some things still require root.
- Keep a copy of the original binary and only test on devices/apps you own or have explicit permission to test.
- When in doubt, restart adb: `adb kill-server && adb start-server`.

--- THE END ---
