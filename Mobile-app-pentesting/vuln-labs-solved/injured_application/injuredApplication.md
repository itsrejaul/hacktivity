# Injured Application

**Credits:**

**Rejaul Islam**  
_Security enthusiast_

............................................

## Important Notes (Prerequisites)

- You must have `adb` set up and the target device/emulator connected.
- Use `apktool`, `jadx`, or `JADX-GUI` for reverse engineering.
- Familiarity with `sqlite3`, `base64`, and common Linux tools helps a lot.
- Only test if you have explicit permission.

---

## Table of Contents

1. Flag-One: Login
2. Flag-Two: Exported Activity
3. Flag-Three: Resources
4. Flag-Four: Login2
5. Flag-Five: Exported Broadcast Receiver
6. Flag-Six: Login3
7. Flag-Seven: SQLITE
8. Flag-Eight: AWS
9. Flag-Nine: Firebase
10. Flag-Ten: Unicode
11. Flag-Eleven: Deep Links
12. Flag-Twelve: Protected components

---

# 1) Flag-One — Login

**Explanation:** In `AndroidManifest.xml` there is an activity called `FlagOneLoginActivity`. Open this activity in JADX, check its `submitFlag` or logic, and you will see the flag.

**Result:**

```text
Flag: F1ag_0n3
```

---

# 2) Flag-Two — Exported Activity

**Explanation:** If an activity has `android:exported="true"`, it can be called externally. Here the activity is `b3nac.injuredandroid.b25lActivity`.

**Command:**

```
adb shell am start -n b3nac.injuredandroid/.b25lActivity
```

**Response:** The activity is triggered and the lab automatically marks this as solved. No need to submit a flag.

---

# 3) Flag-Three — Resources (strings)

**Explanation:** In the activity’s `submitFlag` method, an obfuscated string is referenced. Searching for this string inside `resources.arsc > res/values/strings.xml` reveals the actual flag.

**Example:**

```xml
<string name="cmVzb3VyY2VzX3lv">F1ag_thr33</string>
```

**Result:**

```text
Flag: F1ag_thr33
```

---

# 4) Flag-Four — Login2 (Base64 hiding)

**Explanation:** Decompiled code shows:

```java
private byte[] f1911a = Base64.decode("NF9vdmVyZG9uZV9vbWVsZXRz", 0);
```

Decoding this gives the flag.

**Command:**

```
echo "NF9vdmVyZG9uZV9vbWVsZXRz" | base64 -d
```

**Output:**

```text
4_overdone_omelets
```

---

# 5) Flag-Five — Exported Broadcast Receiver

**Explanation:** In the manifest, `FlagFiveReceiver` is exported. We can trigger it via adb broadcast.

**Command:**

```
adb shell am broadcast -n b3nac.injuredandroid/.FlagFiveReceiver
```

**Response:** Run this 3 times — the lab reveals the flag. (No need to submit manually.)

---

# 6) Flag-Six — Login3 (unsolved)

Not solved yet. Requires further analysis.

---

# 7) Flag-Seven — SQLITE

**Explanation:** The app has a SQLite DB `Thisisatest.db`. Inside, flags are stored as hashed or encoded values.

**Commands:**

```
adb shell
cd /data/data/b3nac.injuredandroid/databases
sqlite3 Thisisatest.db
sqlite> select * from Thisisatest;
```

**Example Response:**

```text
1|The flag hash!|2ab96390c7dbe3439de74d0c9b0b1767 = hunter2
2|The flag is also a password!|9EEADi^^:?;... = S3V3N_11
```

**Tip:**

- Use CrackStation to crack hashes.
- Use ROT-47 decoder (e.g., dCode) for encoded strings.

---

# 8) Flag-Eight — A'W'S credentials in resources

```
<string name="YOUR_ID">AWD_ID</string>
<string name="YOUR_SECRET">YOUR_ECRET_KEY</string>
```

**Lab hint:** Use `cloud_enum` to search for resources.

**Commands:**

```
git clone https://github.com/initstring/cloud_enum.git
cd cloud_enum
python3 -m pip install -r requirements.txt
python3 cloud_enum.py -k injuredandroid
```

---

# 9) Flag-Nine — Firebase

**Explanation:** Code shows Base64 string `flags/`, and `strings.xml` has:

```
<string name="firebase_database_url">https://injuredandroid.firebaseio.com</string>
```

**Command:**

```
curl -s "https://injuredandroid.firebaseio.com/flags/.json"
```

**Response:**

```
["nine!_flag"]
```

**Encoded Submission:**

```
echo -n "[nine!_flag]" | base64
# Output: W25pbmUhX2ZsYWdd
```

---

# 10) Flag-Ten — Unicode

**Explanation:** Unicode homoglyph vulnerabilities (e.g., Turkish dotless i). Example flag submission:

```
John@Gıthub.com
```

---

# 11) Flag-Eleven — Deep Links

**Explanation:** In manifest, there’s an intent-filter for `scheme="flag11"`.

**Command:**

```
adb shell am start -a android.intent.action.VIEW -d "flag11://example"
```

**Response:** App opens the flag input UI.

**Additional Step:** Extract assets to get hidden string.

```
unzip injured-application.apk "assets/*" -d extracted_assets
cd extracted_assets/assets
chmod +x me+$'\353'u
./me+$'\353'u
# Output: HIIMASTRING
```

---

# 12) Flag-Twelve — Protected components

**Explanation:** If the parameter `totally_secure` contains an **https://** URL → success path with flag. If http/plain text → WebView raw render, no flag.

**Commands:**

```
adb shell am start -n b3nac.injuredandroid/.FlagTwelveProtectedActivity --es totally_secure "https://example.com"

adb shell am start -n b3nac.injuredandroid/.FlagTwelveProtectedActivity --es totally_secure "http://example.com"
```

---

## Final Tips

- Always start with `AndroidManifest.xml` — look for exported components, intent filters, and permissions.
- Decode any Base64/ROT/obfuscated strings immediately.
- adb commands are practical — use them to directly trigger internal components.
- Never access cloud/Firebase in real apps without explicit authorization.

Loading.........
