## AllSafe Weak Cryptography bypass script

**Credits:**

**Rejaul Islam**  
_Security enthusiast_

............................................

How it's works:

1. Save this file with "allsafe_weak_crypto.js" extention (you can use your comfortable file name)
2. first run frida server from adb shell
3. Run this script like this -
   --> frida -U -f infosecadventures.allsafe -l allsafe_weak_crypto.js
4. Now Enter your secret messeage and grep into terminal.

........

```

if (Java.available) {
    Java.perform(function () {
        var WeakCrypt = Java.use('infosecadventures.allsafe.challenges.WeakCryptography');

        // Hook encrypt(String)
        try {
            var enc_ov = WeakCrypt.encrypt.overload('java.lang.String');
            // keep original reference
            var enc_orig = enc_ov;
            enc_ov.implementation = function (plain) {
                // log the plaintext provided to encrypt()
                console.log('[*] WeakCryptography.encrypt called');
                console.log('    Plaintext:', plain);

                // call original
                var result;
                try {
                    result = enc_orig.call(this, plain);
                    // result is likely binary; print length and base64 if possible
                    console.log('    Encrypt result (toString):', result);
                } catch (e) {
                    console.log('    Error calling original encrypt:', e);
                }

                return result;
            };
            console.log('[+] Hooked WeakCryptography.encrypt(String)');
        } catch (e) {
            console.log('[-] Failed to hook encrypt:', e);
        }

        // Hook md5Hash(String)
        try {
            var md5_ov = WeakCrypt.md5Hash.overload('java.lang.String');
            var md5_orig = md5_ov;
            md5_ov.implementation = function (txt) {
                console.log('[*] WeakCryptography.md5Hash called');
                console.log('    Input:', txt);
                var out = md5_orig.call(this, txt);
                console.log('    MD5 Hash:', out);
                return out;
            };
            console.log('[+] Hooked WeakCryptography.md5Hash(String)');
        } catch (e) {
            console.log('[-] Failed to hook md5Hash:', e);
        }

        // Hook randomNumber()
        try {
            var rnd_ov = WeakCrypt.randomNumber.overload();
            var rnd_orig = rnd_ov;
            rnd_ov.implementation = function () {
                console.log('[*] WeakCryptography.randomNumber called');
                var out = rnd_orig.call(this);
                console.log('    randomNumber returned:', out);
                return out;
            };
            console.log('[+] Hooked WeakCryptography.randomNumber()');
        } catch (e) {
            console.log('[-] Failed to hook randomNumber:', e);
        }

        // Optional: Hook javax.crypto.Cipher.doFinal to catch ciphertext bytes
        try {
            var Cipher = Java.use('javax.crypto.Cipher');
            var doFinal_overloads = Cipher.doFinal.overloads;
            doFinal_overloads.forEach(function (ov) {
                try {
                    ov.implementation = function () {
                        var args = Array.prototype.slice.call(arguments);
                        console.log('[*] Cipher.doFinal called, args length:', args.length);
                        var res = ov.apply(this, arguments);
                        // res is byte[]
                        try {
                            var ByteArray = Java.use('java.lang.Byte');
                        } catch (e) {}
                        // convert byte[] to hex for printing
                        var hex = bytesToHex(res);
                        console.log('    doFinal output (hex len ' + hex.length + '):', hex);
                        return res;
                    };
                } catch (e) {
                    // ignore
                }
            });
            console.log('[+] Hooked Cipher.doFinal overloads (best-effort)');
        } catch (e) {
            console.log('[-] Failed to hook Cipher.doFinal:', e);
        }

        // helper to convert Java byte[] to hex
        function bytesToHex(javaByteArray) {
            if (!javaByteArray) return 'null';
            try {
                var hexChars = [];
                for (var i = 0; i < javaByteArray.length; i++) {
                    var v = javaByteArray[i] & 0xFF;
                    var hv = v.toString(16);
                    if (hv.length === 1) hv = '0' + hv;
                    hexChars.push(hv);
                }
                return hexChars.join('');
            } catch (e) {
                return '[err converting bytes]';
            }
        }
    });
} else {
    console.log('Java not available');
}


```

.... THE END ....
