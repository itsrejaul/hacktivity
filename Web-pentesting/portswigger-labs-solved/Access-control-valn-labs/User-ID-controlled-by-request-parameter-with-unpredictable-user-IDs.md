### Access control vulnerabilities

**Credits:**

**Rejaul Islam**  
_Security enthusiast_

............................................

## Lab-6: User ID controlled by request parameter, with unpredictable user IDs

# Question:

```
This lab has a horizontal privilege escalation vulnerability on the user account page, but identifies users with GUIDs.
To solve the lab, find the GUID for carlos, then submit his API key as the solution.
You can log in to your own account using the following credentials: wiener:peter
```

## Step to Produce:

1. Before solving this question, we need to know what is horizontal privilege escalation vulnerability? This vulnerability means I can privilege my account to another same type user account.
2. After login with this given credentials. Again I click My Account and grep this req into burpsuite but this time this id looking like this -

```
GET /my-account?id=37ca0e53-0600-4c54-886a-971da0dbf75a
```

This id format is GUID (Globally Unique Identifier). It's not easy to predict. 3. Now I try to find the id from comments. But I can’t here user id not revealed, but sometimes when any user comments on any blog post then user id revealed. I simply follow this terminology but unfortunately this is not working for this time. 4. Then I visit all the blog posts and I notice that - every blog post author is different and the interesting part is i found the carlos user’s id from a blog post. Carlos blog post title is -

```
If I Close My Eyes You Can't See Me
```

5. When I found this blog post then I clicked the author name and grep this request into burpsuite and I found Carlos user id. Copy this id and again click My Account and grep this request into burp now edit the user id that you copied earlier.

```
GET /my-account?id=64d1d02a-6f26-4ce4-89d4-34a41ec6be2f
```

6. Now you are into Carlos dashboard and see the API_KEY. Copy this API_KEY and submit.

```
Your username is: carlos
Your API Key is: MA0oBCarOoWNm8mNrNh8FKn0ylxANmHH
```

Your task is completed.

— THE END —
