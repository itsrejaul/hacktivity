### Access control vulnerabilities

**Credits:**

**Rejaul Islam**  
_Security enthusiast_

............................................

## Lab-2: Unprotected admin functionality with unpredictable URL

# Question:

```
This lab has an unprotected admin panel. It's located at an unpredictable location, but the location is disclosed somewhere in the application.

Solve the lab by accessing the admin panel, and using it to delete the user carlos.
```

## Step to Produce:

1. First I access this lab and see the functionality. Then I again decided to visit robots.txt to find out about this admin panel. But no information I found from the _robtos.txt_ file.
2. Look at the question hint. The admin panel is unpredictable. That's why I think brute force is not working here.
3. Then I click _my account_ button and find a login form, but I don't have any credentials for login.
4. After that I decided to see the source code. _Right-click_ on browser and see the source code or _Ctrl+u_ to see the source code.
5. When i read the source code i notice an interesting js script -

```
var isAdmin = false;
if (isAdmin) {
   var topLinksTag = document.getElementsByClassName("top-links")[0];
   var adminPanelTag = document.createElement('a');
   adminPanelTag.setAttribute('href', '/admin-9pqah4'); // this is the admin panel endpoint
   adminPanelTag.innerText = 'Admin panel';
   topLinksTag.append(adminPanelTag);
   var pTag = document.createElement('p');
   pTag.innerText = '|';
   topLinksTag.appendChild(pTag);
}
```

6. Copy this endpoint and paste it after the url and find the _Admin-panel_ and delete user _carlos_ and complete your task.

```
https://<lab-url-here>/admin-9pqah4
```

--- THE END ---
