### Access control vulnerabilities

**Credits:**

**Rejaul Islam**  
_Security enthusiast_

............................................

## Lab-5: User ID controlled by request parameter

# Question:

```
This lab has a horizontal privilege escalation vulnerability on the user account page.
To solve the lab, obtain the API key for the user carlos and submit it as the solution.
You can log in to your own account using the following credentials: wiener:peter

```

## Step to Produce:

1. Before solving this question, we need to know that _What is horizontal privilege escalation vulnerability?_ This vulnerability means _I can privilege my account to another same type user account_ .
2. After login with given credentials I see an api key for _wiener_ user -

```
Your username is: wiener
Your API Key is: Pkm77GJUhP8iVkGHtdAnkiUdXcxL3aDb
```

But we need to find the carlos users api, right? 3. After click _My Account_ again I can see the email update functionality. Again I try to update email for carlos, like this -

```
carlos@gmail.com
```

But it’s not working this time. 4. Again I try to grep request when i click _My Account_. Now I can see an interesting parameter, I think this parameter and values confirm the user. Then i decided to change this value to _carlos_

```
GET /my-account?id=wiener
```

To

```
GET /my-account?id=carlos
```

5. After send this updated _GET_ request. Now I can see the carlos user’s api key.

```
Your username is: carlos
Your API Key is: PSXMGHJbBWditSmGaZvfwShpdPlF88E9

```

6. Copy this API key and submit and complete your task for this problem.

— THE END —
