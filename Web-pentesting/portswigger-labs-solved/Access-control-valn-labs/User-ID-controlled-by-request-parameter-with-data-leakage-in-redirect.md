### Access control vulnerabilities

**Credits:**

**Rejaul Islam**  
_Security enthusiast_

............................................

## Lab-7: User ID controlled by request parameter with data leakage in redirect

# Question:

```
This lab contains an access control vulnerability where sensitive information is leaked in the body of a redirect response.
To solve the lab, obtain the API key for the user carlos and submit it as the solution.
You can log in to your own account using the following credentials: wiener:peter
t using the following credentials: wiener:peter
```

## Step to Produce:

1. First I login with given credentials. Then I explore some times on this website. But without my account I can’t find anything suspicious.
2. Then I click My Account and grep this request into burp. Now I can see this req like this -

```
GET /my-account?id=wiener
```

3. Then I try to change this value wiener to carlos and forward this req. But after going forward and forwarding this, automatically I Logout from this website.
4. Again I click on My Account button and grep into burp. This time I select “Do Entercept” and I see all the req and response. After changing user “wiener to carlos” I found 302 status code but I found carlos users API_KEY from this req body. Copy this api_key and submit. This task is completed now.

```
Your username is: carlos
 Your API Key is: xjTpCdBxOFHLQa456yNgK0ON2Qytx4o9

```

That means when it does not match the query value with the login username. Then this website automatically logout the login user. But before Logout It disclose others users credentials.

— THE END —
