### Access control vulnerabilities

**Credits:**

**Rejaul Islam**  
_Security enthusiast_

............................................

## Lab-4: User role can be modified in user profile

# Question:

```
This lab has an admin panel at /admin. It's only accessible to logged-in users with a roleid of 2.
Solve the lab by accessing the admin panel and using it to delete the user carlos.
You can log in to your own account using the following credentials: wiener:peter

```

## Step to Produce:

1. First I use this website as a normal user and explore all functionality but I dont see where roleid.
2. Then I click _My Account_ and found an email update functionality. That means I can change my email. This also a vulnerability because I can update my email to admin or other user email. Then can takeover _admin_ or _normal-users_ account which is a critical vulnerability.
3. Then I Enter an email name *peter@gmail.com* and grep this req into burp. After grep this request, Send this request into repeater tab and forward this req and I Found this response into response tab -

```
{
  "username": "wiener",
  "email": "peter@gmail.com",
  "apikey": "RltO58VtLZmsAcv9740D1zgVTZjBhM1z",
  "roleid": 1
}

```

4. We can see here our target key which is _roleid_. But the interesting things is in the req body I don’t have this field that i can edit this _roleid_.
5. Is this case- if developers don’t validate this req into server side, then we can inject this field into the request body. Now i add this field into req body, like this -

```
{"email":"peter@gmail.com",
"roleid": 2
}

```

We know, if _roleid=2_ then we can access the admin panel. 6. After forward this req, reload your browser, and now you should see the _Admin Panel_. Now click _Admin Panel_ and find the user carlos and delete this user and complete your task.

— THE END —
